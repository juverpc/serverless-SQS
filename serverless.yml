service: second-test

frameworkVersion: "2"

provider:
  name: aws
  runtime: python3.6
  eventBridge.useCloudFormation: true
  lambdaHashingVersion: 20201221
  iam:
    role: arn:aws:iam::624733648801:role/Role-serverless-function
  deploymentBucket:
    name: codebuildjuver
    serverSideEncryption: AES256
  #deploymentPrefix: serverless/example
#   ecr:
#     # In this section you can define images that will be built locally and uploaded to ECR
#     scanOnPush: true
#     images:
#       lambda-01-images:
#         path: ./lambda/lambda01
#         file: Dockerfile  
#         buildArgs:
#           AWS_DEFAULT_REGION: ${self:provider.region}
#           AWS_CONTAINER_CREDENTIALS_RELATIVE_URI: ${env:AWS_CONTAINER_CREDENTIALS_RELATIVE_URI}
#       # lambda-02-images:
#       #   path: ./lambda/lambda02
#       #   file: Dockerfile  
#       #   buildArgs:
#       #     AWS_DEFAULT_REGION: ${self:provider.region}
#       #     AWS_CONTAINER_CREDENTIALS_RELATIVE_URI: ${env:AWS_CONTAINER_CREDENTIALS_RELATIVE_URI}
      
         

# plugins:
#   - serverless-deployment-bucket


# functions:
#   lambda-01:
#     image:
#       name: lambda-01-images
#       command:
#         - lambda_function.lambda_handler
    # events:
    #   - eventBridge:
    #       schedule: cron(*/10 8-23 * * ? *)
    #       Description: serverless test lambda-01

  # lambda-02:
  #   image:
  #     name: lambda-02-images
  #     command:
  #       - lambda_function.lambda_handler
  #   events:
  #     - eventBridge:
  #         schedule: cron(*/10 8-23 * * ? *)
  #         Description: serverless test lambda-02

resources:
  Resources:
    ruletestserverless:
      Type: AWS::Events::Rule
      Properties:
        Name: testrule
        EventBusName: 'default'
        Description: "Test from serverless Framework"
        #RoleArn: 'arn:aws:iam::624733648801:role/service-role/AmazonSageMakerServiceCatalogProductsUseRole'
        State: 'ENABLED'
        EventPattern:
          source:
            - aws.s3
          detail: 
            eventSource: 
              - s3.amazonaws.com
            eventName: 
              - PutObject
            requestParameters:
              bucketName: 
                - prefix: juver-upload-to-s3/model1/1/
        Targets:
            - 
              Arn: 'arn:aws:sagemaker:us-east-1:624733648801:pipeline/pipelinenametest2'
              Id: 'Id1234'
              RoleArn: 'arn:aws:iam::624733648801:role/service-role/AmazonSageMakerServiceCatalogProductsUseRole'
              Input: '{ "stand_menu_uuid": " e0b09ee1-1dbf-46b5-87be-33852007547b" }'
    
